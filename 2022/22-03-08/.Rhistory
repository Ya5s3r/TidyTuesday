ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=1/4) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "<span style='color:#4f1f10'>Erasmus</span> mobility for students",
subtitle = "Top 10 transfers<br>",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"))
library(ggtext)
ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=1/4) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "<span style='color:#4f1f10'>Erasmus</span> mobility for students",
subtitle = "Top 10 transfers<br>",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"))
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=1/4) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "<span style='color:#4f1f10'>Erasmus</span> mobility for students",
subtitle = "Top 10 transfers<br>",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"))
p
ggsave(p, filename = "Erasmus-Mobility.png",
device = "png", width = 35, height = 20.5,
units = "cm", dpi = 300)
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=1/4) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping <span style='color:#4f1f10'>Erasmus</span> mobility for students",
subtitle = "Top 10 transfers<br>",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"))
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=1/4) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping <span style='color:#4f1f10'>Erasmus</span> mobility for students",
subtitle = "Top 10 transfers<br>",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"))
p
external_transfer_plot[11:100,]
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=1/4) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping <span style='color:#4f1f10'>Erasmus</span> mobility for students",
subtitle = "Top 10 transfers<br>",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"))
p
#external_transfer_plot[11:100,]
extrafont::loadfonts()
extrafont::loadfonts()
view(extrafont::fonttable())
extrafont::fonts()
extrafont::loadfonts()
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=1/4) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping <span style='color:#4f1f10'>Erasmus</span> mobility for students",
subtitle = "Top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"))
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=1/4) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** mobility for students",
subtitle = "Top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"))
p
ggsave(p, filename = "Erasmus-Mobility.png",
device = "png", width = 35, height = 20.5,
units = "cm", dpi = 300)
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.1) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"))
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.1) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1)
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05) +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1)
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05, color = "black") +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1)
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05, color = "grey3") +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1)
p
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05, color = "gray1") +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1)
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
size = 1,
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05, color = "gray1") +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1)
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
size = 1,
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05, color = "gray1") +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1) +
guides(color = guide_colorbar(barwidth = 12, barheight = 0.5, title.position = "top"),
size = guide_legend(title.position = "top"))
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
size = 1,
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05, color = "gray1") +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1) +
guides(color = guide_colorbar(barwidth = 12, barheight = 0.5, title.position = "top"),
size = guide_legend(title.position = "top"))
p
#external_transfer_plot[11:100,]
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
size = 1,
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05, color = "gray1") +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "#e8f0fc"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1) +
guides(color = guide_colorbar(barwidth = 12, barheight = 0.5, title.position = "top"),
size = guide_legend(title.position = "top"))
p
#external_transfer_plot[11:100,]
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
size = 1,
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05, color = "gray1") +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "#white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1) +
guides(color = guide_colorbar(barwidth = 12, barheight = 0.5, title.position = "top"),
size = guide_legend(title.position = "top"))
p
p <- ggplot(data = filtered_map, aes(x=long, y=lat)) +
geom_map(aes(map_id=region),map = filtered_map, color="black", fill="#7f7f7f", size=0.1, alpha=0.05) +
geom_curve(data = external_transfer_plot[1:10,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving, color = total),
size = 1,
arrow = arrow(length = unit(1.5, "mm"),
type = "closed")) +
geom_curve(data = external_transfer_plot[11:100,],
aes(x = long.sending, y = lat.sending, yend = lat.receiving, xend = long.receiving), size = 0.05, color = "gray1") +
coord_cartesian(xlim = c(-25, 50), ylim = c(39, 65)) +
#coord_proj("+proj=wintri") +
labs(title = "Mapping **Erasmus** Mobility For Students",
subtitle = "Highlighting the top 10 transfers",
caption = "Coloured arrows indicate top 10 most frequent exchanges between countires \n Greyed lines indicates top 100 ") +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
text = element_text(family = "Fredoka"),
legend.position = "bottom"
) +
scale_fill_viridis(aesthetics = c("point_color", "fill", "color"), direction = -1) +
guides(color = guide_colorbar(barwidth = 12, barheight = 0.5, title.position = "top"),
size = guide_legend(title.position = "top"))
p
ggsave(p, filename = "Erasmus-Mobility.svg",
device = "svg", width = 35, height = 20.5,
units = "cm", dpi = 400)
ggsave(p, filename = "Erasmus-Mobility.png",
device = "png", width = 35, height = 20.5,
units = "cm", dpi = 400)
